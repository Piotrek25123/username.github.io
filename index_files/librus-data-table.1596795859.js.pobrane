var librusDataTable=function(t){var e={};function n(a){if(e[a])return e[a].exports;var r=e[a]={i:a,l:!1,exports:{}};return t[a].call(r.exports,r,r.exports,n),r.l=!0,r.exports}return n.m=t,n.c=e,n.d=function(t,e,a){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:a})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var a=Object.create(null);if(n.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var r in t)n.d(a,r,function(e){return t[e]}.bind(null,r));return a},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=3)}([function(t,e){t.exports=redom},function(t,e){t.exports=_},function(t,e,n){},function(t,e,n){"use strict";n.r(e);var a=n(0),r=n(1),i=n.n(r);var o=function(t){return t=t||Object.create(null),{on:function(e,n){(t[e]||(t[e]=[])).push(n)},off:function(e,n){t[e]&&t[e].splice(t[e].indexOf(n)>>>0,1)},emit:function(e,n){(t[e]||[]).slice().map((function(t){t(n)})),(t["*"]||[]).slice().map((function(t){t(e,n)}))}}},c=_.partial(_.set,_,"value",_);function s(t,e){for(var n=0;n<e.length;n++){var a=e[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(t,a.key,a)}}var u=function(){function t(e){var n=this;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.data=e;var r=e.value,i=void 0!==r&&r;this.el=Object(a.el)("input",{type:"checkbox",checked:i}),this.el.onchange=function(){return c(e,n.el.checked)}}var e,n,r;return e=t,(n=[{key:"clear",value:function(){c(this.data,!1),Object(a.setAttr)(this.el,{checked:!1})}}])&&s(e.prototype,n),r&&s(e,r),t}();function l(t,e){for(var n=0;n<e.length;n++){var a=e[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(t,a.key,a)}}var f=function(){function t(){var e=this,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),i.a.isEmpty(n)&&(n.startDate={value:""},n.endDate={value:""}),this.data={startDate:i.a.find(n,["key","startDate"])||n.startDate,endDate:i.a.find(n,["key","endDate"])||n.endDate},this.el=Object(a.el)("div",[this.startDate=Object(a.el)("input",{type:"text",name:"startDate",class:"small",value:i.a.get(this.data.startDate,"value","")}),Object(a.el)("span"," - "),this.endDate=Object(a.el)("input",{type:"text",name:"endDate",class:"small",value:i.a.get(this.data.endDate,"value","")})]),this.startDate.onchange=function(t){return c(e.data.startDate,t.target.value)},this.endDate.onchange=function(t){return c(e.data.endDate,t.target.value)}}var e,n,r;return e=t,(n=[{key:"clear",value:function(){this.clearStartDate(),this.clearEndDate()}},{key:"clearStartDate",value:function(){c(this.data.startDate,null),Object(a.setAttr)(this.startDate,{value:""})}},{key:"clearEndDate",value:function(){c(this.data.endDate,null),Object(a.setAttr)(this.endDate,{value:""})}},{key:"onmount",value:function(){var t=this;$(this.startDate).datepicker().change((function(){t.validateStartDate($(t.startDate).datepicker("getDate"),$(t.endDate).datepicker("getDate"))})),$(this.endDate).datepicker().change((function(){t.validateEndDate($(t.endDate).datepicker("getDate"),$(t.startDate).datepicker("getDate"))}))}},{key:"validateStartDate",value:function(t,e){if(!t||!e)return!1;t>e&&this.showAlert("Wybrano datę późniejszą niż data zamykająca przedział.")}},{key:"validateEndDate",value:function(t,e){if(!t||!e)return!1;t<e&&this.showAlert("Wybrano datę wcześniejszą niż data otwierająca przedział.")}},{key:"showAlert",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"Ostrzeżenie",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"warning";!i.a.isUndefined(window.show_message)&&i.a.isFunction(window.show_message)?window.show_message(n,e,t,["ok"]):alert(t)}}])&&l(e.prototype,n),r&&l(e,r),t}();var h=function t(e){var n=e.value,r=void 0===n?"":n,i=e.className;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.el=Object(a.el)("div",r),i&&Object(a.setAttr)(this.el,{className:i})};function p(t,e){if(i.a.isFunction(t.renderer))return t.renderer(i.a.isUndefined(t.value)?e:t);switch(t.type){case"checkbox":return new u(t);case"text":return Object(a.text)(t.value);case"dateRange":return new f(e);case"caption":return new h(t);default:return Object(a.text)(t.value)}}function d(t,e){for(var n=0;n<e.length;n++){var a=e[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(t,a.key,a)}}var b=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.el=Object(a.el)("td")}var e,n,r;return e=t,(n=[{key:"update",value:function(t,e,n,r){this.data=t,this.cell=p(this.data,r),!this.data.phantom&&Object(a.setChildren)(this.el,this.cell),this.data.classList&&Object(a.setAttr)(this.el,{className:t.classList}),this.data.colspan&&Object(a.setAttr)(this.el,{colspan:t.colspan})}}])&&d(e.prototype,n),r&&d(e,r),t}();function v(t,e){for(var n=0;n<e.length;n++){var a=e[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(t,a.key,a)}}var y=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.el=Object(a.el)("tr"),this.list=Object(a.list)(this.el,b)}var e,n,r;return e=t,(n=[{key:"update",value:function(t){this.list.update(i.a.reject(t,"phantom"),i.a.filter(t,"key"))}}])&&v(e.prototype,n),r&&v(e,r),t}();function O(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);e&&(a=a.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,a)}return n}function m(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function j(t,e){for(var n=0;n<e.length;n++){var a=e[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(t,a.key,a)}}var w=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.el=Object(a.el)("th"),this.batchEditElements=[]}var e,n,r;return e=t,(n=[{key:"update",value:function(t,e,n,r){var i=r.emitter,o=t.rowspan,c=t.colspan,s=t.classList,u=t.tooltip,l=t.width,f=t.title,h=t.type,d=t.element;switch(i.emit("updateThead",{theadData:t,element:this.el}),this.el.removeAttribute("rowspan"),o&&Object(a.setAttr)(this.el,{rowspan:o}),this.el.removeAttribute("colspan"),c&&Object(a.setAttr)(this.el,{colspan:c}),this.el.removeAttribute("class"),s&&Object(a.setAttr)(this.el,{className:s}),this.el.removeAttribute("title"),u&&Object(a.setAttr)(this.el,{title:u}),l&&Object(a.setStyle)(this.el,{width:l}),h){case"caption":return Object(a.setChildren)(this.el,p(function(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?O(n,!0).forEach((function(e){m(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):O(n).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}({},t,{value:f})))}f&&(this.el.textContent=f),d&&Object(a.setChildren)(this,d)}}])&&j(e.prototype,n),r&&j(e,r),t}();function g(t,e){for(var n=0;n<e.length;n++){var a=e[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(t,a.key,a)}}var k=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.el=Object(a.el)("tr"),this.list=Object(a.list)(this.el,w)}var e,n,r;return e=t,(n=[{key:"update",value:function(t,e,n,a){this.list.update(i.a.reject(t,"phantom"),a)}}])&&g(e.prototype,n),r&&g(e,r),t}();function D(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);e&&(a=a.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,a)}return n}function P(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function E(t,e){for(var n=0;n<e.length;n++){var a=e[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(t,a.key,a)}}var S=function(){function t(e,n){var r=this;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t);var o=n.emitter,c=n.setValues;if(this.dataTable=n,this.setValues=i.a.bind(c,n,"selected"),this.state={checked:!1},this.element=Object(a.el)("input",{type:"checkbox",checked:this.state.checked,onclick:function(t){return r.setSelection(t.target.checked)}}),!i.a.isPlainObject(e))throw new Error("Selection configuration must be a object");if(i.a.isEmpty(e))throw new Error("Selection configuration can't be empty object");var s={type:"checkbox",title:"",dataIndex:"selected",rowspan:1,cellClassList:"center",selectAll:!0,element:this.element};n.addColumn(function(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?D(n,!0).forEach((function(e){P(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):D(n).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}({},s,{},e.columnConfig||{}),e.columnConfig.insertRowIndex),o.on("udpate",(function(){r.deselectAll()}))}var e,n,r;return e=t,(n=[{key:"selectAll",value:function(){this.setSelection(!0)}},{key:"deselectAll",value:function(){this.setSelection(!1)}},{key:"setSelection",value:function(t){this.state.checked=t,this.setValues(t),Object(a.setAttr)(this.element,{checked:t})}}])&&E(e.prototype,n),r&&E(e,r),t}();function A(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);e&&(a=a.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,a)}return n}function x(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function C(t,e){for(var n=0;n<e.length;n++){var a=e[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(t,a.key,a)}}var T=function(){function t(e,n){var a=this;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t);var r=n.emitter;this.updateData=i.a.bind(n.updateData,n),this.state={values:{},cells:[]},r.on("updateThead",(function(t){var e=t.theadData,n=t.element,r=e.type,i=e.dataIndex,o=e.columnType,c=e.renderer,s=e.cellClassList;"batchEdit"===r&&i&&a.createEditor(i,o,c,n),"batchEdit"===r&&"submit"===o&&a.createSubmitButton(s,n)}))}var e,n,r;return e=t,(n=[{key:"createEditor",value:function(t,e,n,r){var o=this,c={},s=i.a.flow([function(t){return i.a.isArray(t)?t:[t]},function(t){return i.a.map(t,(function(t){return{key:t,value:null}}))}])(t);i.a.forEach(s,(function(t){var e=t.key,n=t.value;o.state.values[e]={value:n}})),e&&i.a.isString(t)&&(this.state.values[t]=function(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?A(n,!0).forEach((function(e){x(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):A(n).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}({},this.state.values[t],{type:e}),c=p(this.state.values[t])),e&&i.a.isArray(t)&&(c=p({type:e},this.state.values)),n&&(c=n(this.state.values)),this.state.cells.push(c),Object(a.setChildren)(r,c)}},{key:"createSubmitButton",value:function(t,e){var n=this;Object(a.setChildren)(e,Object(a.el)("button","Ustaw zaznaczonym",{type:"button",className:t,onclick:function(){return n.batchEdit()}}))}},{key:"batchEdit",value:function(){var t=this;i.a.forEach(this.state.values,(function(e,n){var a=e.value;t.updateData(n,a,!0)})),i.a.each(this.state.cells,(function(t){return t.clear()}))}}])&&C(e.prototype,n),r&&C(e,r),t}();n(2);function z(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);e&&(a=a.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,a)}return n}function L(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?z(n,!0).forEach((function(e){V(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):z(n).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function V(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function N(t,e){for(var n=0;n<e.length;n++){var a=e[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(t,a.key,a)}}n.d(e,"DataTable",(function(){return M})),n.d(e,"create",(function(){return B}));var I={data:[]},M=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.options=L({},I,{},e||{}),this.emitter=new o,this.el=Object(a.el)("table",[this.caption=Object(a.el)("caption"),this.thead=Object(a.list)("thead",k),this.tbody=Object(a.list)("tbody",y),this.tfoot=Object(a.list)("tfoot",y)]),this.state={data:[]},this.init(this.options)}var e,n,r;return e=t,(n=[{key:"setState",value:function(t){this.state=L({},this.state,{},t)}},{key:"init",value:function(t){var e;this.selection=t.selection&&(e=t.selection,new S(e,this)),this.batchEditor=function(t,e){return new T(t,e)}({},this),Object(a.setAttr)(this.el,{className:"librus-data-table ".concat(t.classList||"")}),t.title?this.caption.textContent=t.title:Object(a.unmount)(this.el,this.caption),i.a.isArray(t.columns)&&(t.columns={rows:[t.columns]}),this.tfoot.update(t.footer||[]),this.updateThead(t.columns.rows||[]),this.initData(t)}},{key:"initData",value:function(t){var e=i.a.flatten(t.columns.rows),n=i.a.flow([function(t){return i.a.reject(t,{type:"caption"})},function(t){return i.a.reject(t,{type:"batchEdit"})}])(e),a=t.data.map((function(t){return n.map((function(e){return{key:e.dataIndex,value:i.a.get(t,e.dataIndex),type:e.type,classList:i.a.get(e,"cellClassList",""),renderer:e.renderer,phantom:e.phantom||!1}}))}));this.setState({data:a}),this.tbody.update(a)}},{key:"updateData",value:function(t,e){var n=this,a=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=this.state.data.map((function(r){var o=i.a.get(i.a.find(r,["key","selected"]),"value",!1);return(a&&o||!a)&&n.setValue(r)(t,e),r}));this.setState({data:r}),this.tbody.update(r)}},{key:"setValue",value:function(t){return function(e,n){i.a.flow([function(t){return i.a.find(t,["key",e])},function(t){return i.a.set(t,"value",n)}])(t)}}},{key:"updateThead",value:function(t){this.thead.update(t,this)}},{key:"addColumn",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;this.options.columns.rows[e].splice(n,0,t),this.updateThead(this.options.columns.rows),this.initData(this.options)}},{key:"setValues",value:function(t,e){this.updateData(t,e)}},{key:"getSelection",value:function(){return this.getData().filter((function(t){return t.selected}))}},{key:"getData",value:function(){return i.a.map(i.a.assign([],this.state.data),i.a.flow([function(t){return i.a.filter(t,"key")},function(t){return i.a.keyBy(t,"key")},function(t){return i.a.mapValues(t,"value")}]))}},{key:"update",value:function(t){this.emitter.emit("udpate"),this.options.data=t,this.initData(this.options)}}])&&N(e.prototype,n),r&&N(e,r),t}(),B=function(t){return new M(t)}}]);